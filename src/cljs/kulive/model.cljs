(ns kulive.model
  (:require [clojure.string :as str]
            [reagent.core :as reagent]
            [re-frame.core :as re-frame])
  (:require-macros [reagent.ratom  :refer [reaction]]))

(def dummy-data {"DISS352-00" {:kr {:professor "이지수", :schedule ["화(1) 국제관322" "\n목(1) 국제관322"], :r false, :number "DISS352-00", :name " 국제법특강I(영강)", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=3928&dept_cd=3931&cour_cd=DISS352&cour_cls=00&cour_nm=국제법특강I(영강)"}, :en {:professor nil, :schedule ["Tue(1) 138-322" "\nThu(1) 138-322"], :r false, :number "DISS352-00", :name "SPECIAL TOPICS IN INTERNATIONAL LAW I(English)", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=3928&dept_cd=3931&cour_cd=DISS352&cour_cls=00&cour_nm=SPECIAL TOPICS IN INTERNATIONAL LAW I(English)"}}, "EDBA231-02" {:kr {:professor "박철", :schedule ["월(9) 33-221" "\n목(1-2) 33-325"], :r true, :number "EDBA231-02", :name " 마케팅원론", :w false, :l true, :classification "전공필수 ", :credit-hours "3(  3)", :x true, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0293&dept_cd=4633&cour_cd=EDBA231&cour_cls=02&cour_nm=마케팅원론"}, :en {:professor "Cheol Park", :schedule ["Mon(9) 33-221" "\nThu(1-2) 33-325"], :r true, :number "EDBA231-02", :name "PRINCIPLES OF MARKETING", :w false, :l true, :classification "Major Required", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0293&dept_cd=4633&cour_cd=EDBA231&cour_cls=02&cour_nm=PRINCIPLES OF MARKETING"}}, "KFBT253-00" {:kr {:professor "김영준", :schedule ["수(3-4) 7-217" "\n목(4) 9-615A"], :r true, :number "KFBT253-00", :name " 세포생물학", :w false, :l false, :classification "기본전공선택 ", :credit-hours "3(  3)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4554&cour_cd=KFBT253&cour_cls=00&cour_nm=세포생물학"}, :en {:professor "Young Jun Kim", :schedule ["Wed(3-4) 7-217" "\nThu(4) 9-615A"], :r true, :number "KFBT253-00", :name "CELL BIOLOGY", :w false, :l false, :classification "Basic Major", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4554&cour_cd=KFBT253&cour_cls=00&cour_nm=CELL BIOLOGY"}}, "BUSS207-03" {:kr {:professor "김우찬", :schedule ["화(1) 현차관B204" "\n목(1) 현차관B204"], :r false, :number "BUSS207-03", :name " 재무관리(영강)", :w false, :l true, :classification "전공필수 ", :credit-hours "3(  3)", :x false, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0140&dept_cd=0142&cour_cd=BUSS207&cour_cls=03&cour_nm=재무관리(영강)"}, :en {:professor "Kim, Woochan", :schedule ["Tue(1) 151-B204" "\nThu(1) 151-B204"], :r false, :number "BUSS207-03", :name "FINANCIAL MANAGEMENT(English)", :w false, :l true, :classification "Major Required", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0140&dept_cd=0142&cour_cd=BUSS207&cour_cls=03&cour_nm=FINANCIAL MANAGEMENT(English)"}}, "CHEM300-01" {:kr {:professor "이광렬", :schedule [], :r true, :number "CHEM300-01", :name " 전공심화연구I", :w false, :l false, :classification "전공선택 ", :credit-hours "3(  6)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0209&dept_cd=0213&cour_cd=CHEM300&cour_cls=01&cour_nm=전공심화연구I"}, :en {:professor "Kwangyeol Lee", :schedule [], :r true, :number "CHEM300-01", :name "UNDERGRADUATE ADVANCED RESEARCH I", :w false, :l false, :classification "Major Elective", :credit-hours "3(  6)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0209&dept_cd=0213&cour_cd=CHEM300&cour_cls=01&cour_nm=UNDERGRADUATE ADVANCED RESEARCH I"}}, "ELED241-00" {:kr {:professor "황지연", :schedule ["화(2) 사대신관 124" "\n목(2) 사대신관 124"], :r true, :number "ELED241-00", :name " 영미아동문학강독(영강)", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0234&dept_cd=0241&cour_cd=ELED241&cour_cls=00&cour_nm=영미아동문학강독(영강)"}, :en {:professor "Ji Yeon Hwang", :schedule ["Tue(2) 110-124" "\nThu(2) 110-124"], :r true, :number "ELED241-00", :name "READINGS IN ENGLISH CHILDREN'S LITERATURE(English)", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0234&dept_cd=0241&cour_cd=ELED241&cour_cls=00&cour_nm=READINGS IN ENGLISH CHILDREN'S LITERATURE(English)"}}, "ENGL421-03" {:kr {:professor "이종임", :schedule ["화(5) 교양관 402" "\n목(5) 교양관 402"], :r true, :number "ENGL421-03", :name " 영미문학특수과제Ⅰ(영강)", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0146&cour_cd=ENGL421&cour_cls=03&cour_nm=영미문학특수과제Ⅰ(영강)"}, :en {:professor "Jong-Im Lee", :schedule ["Tue(5) 108-402" "\nThu(5) 108-402"], :r true, :number "ENGL421-03", :name "SPECIAL TOPICS IN BRITISH AND AMERICAN LITERATURE(English)", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0146&cour_cd=ENGL421&cour_cls=03&cour_nm=SPECIAL TOPICS IN BRITISH AND AMERICAN LITERATURE(English)"}}, "COSE496-00" {:kr {:professor "한정현", :schedule [], :r false, :number "COSE496-00", :name " 현장실습II", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  0)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5720&dept_cd=5722&cour_cd=COSE496&cour_cls=00&cour_nm=현장실습II"}, :en {:professor "HAN, JUNGHYUN", :schedule [], :r false, :number "COSE496-00", :name "INTERNSHIP PROGRAM II", :w false, :l true, :classification "Major Elective", :credit-hours "3(  0)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5720&dept_cd=5722&cour_cd=COSE496&cour_cls=00&cour_nm=INTERNSHIP PROGRAM II"}}, "LSSS471-00" {:kr {:professor "배상우", :schedule ["수(8-9) 33-324"], :r false, :number "LSSS471-00", :name " 스포츠이벤트실습(영강)", :w false, :l true, :classification "전공선택 ", :credit-hours "1(  2)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS471&cour_cls=00&cour_nm=스포츠이벤트실습(영강)"}, :en {:professor "Sang Woo Bae", :schedule ["Wed(8-9) 33-324"], :r false, :number "LSSS471-00", :name "SPORT EVENT FIELDWORK(English)", :w false, :l true, :classification "Major Elective", :credit-hours "1(  2)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS471&cour_cls=00&cour_nm=SPORT EVENT FIELDWORK(English)"}}, "KHSU230-00" {:kr {:professor "전옥희", :schedule ["금(1-2) 하나과학관 B117호"], :r true, :number "KHSU230-00", :name " 생화학", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4669&dept_cd=4893&cour_cd=KHSU230&cour_cls=00&cour_nm=생화학"}, :en {:professor "Ok-Hee Jeon", :schedule ["Fri(1-2) B117"], :r true, :number "KHSU230-00", :name "BIOCHEMISTRY", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4669&dept_cd=4893&cour_cd=KHSU230&cour_cls=00&cour_nm=BIOCHEMISTRY"}}, "CSIE309-02" {:kr {:professor "정용화", :schedule ["화(5-6) 7-324" "\n목(2) 7-310"], :r true, :number "CSIE309-02", :name " 알고리즘", :w false, :l true, :classification "전공필수 ", :credit-hours "3(  3)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4548&cour_cd=CSIE309&cour_cls=02&cour_nm=알고리즘"}, :en {:professor "Yongwha Chung", :schedule ["Tue(5-6) 7-324" "\nThu(2) 7-310"], :r true, :number "CSIE309-02", :name "ALGORITHM", :w false, :l true, :classification "Major Required", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4548&cour_cd=CSIE309&cour_cls=02&cour_nm=ALGORITHM"}}, "LING481-00" {:kr {:professor "김성도", :schedule ["화(5) 교육관307" "\n목(5) 교육관307"], :r true, :number "LING481-00", :name " 언어학특강I", :w false, :l false, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=4391&cour_cd=LING481&cour_cls=00&cour_nm=언어학특강I"}, :en {:professor "Kim Sung Do", :schedule ["Tue(5) 140-307" "\nThu(5) 140-307"], :r true, :number "LING481-00", :name "TOPICS IN LINGUISTICS I", :w false, :l false, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=4391&cour_cd=LING481&cour_cls=00&cour_nm=TOPICS IN LINGUISTICS I"}}, "ELED217-01" {:kr {:professor "Grace Kim", :schedule ["월(5) 교육관312" "\n수(5) 교육관312"], :r false, :number "ELED217-01", :name " 영어교과논리및논술(영강)", :w false, :l true, :classification "전공필수 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0234&dept_cd=0241&cour_cd=ELED217&cour_cls=01&cour_nm=영어교과논리및논술(영강)"}, :en {:professor "Grace Kim", :schedule ["Mon(5) 140-312" "\nWed(5) 140-312"], :r false, :number "ELED217-01", :name "ENGLISH READING AND WRITING(English)", :w false, :l true, :classification "Major Required", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0234&dept_cd=0241&cour_cd=ELED217&cour_cls=01&cour_nm=ENGLISH READING AND WRITING(English)"}}, "MEDI414-00" {:kr {:professor "이혜원", :schedule [], :r false, :number "MEDI414-00", :name " 마취통증의학임상실습", :w false, :l false, :classification "전공선택 ", :credit-hours "2(  0)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0226&dept_cd=0229&cour_cd=MEDI414&cour_cls=00&cour_nm=마취통증의학임상실습"}, :en {:professor "Hye Won Lee", :schedule [], :r false, :number "MEDI414-00", :name "ANESTHESIOLOGY & PAIN MEDICINE CLERKSHIP", :w false, :l false, :classification "Major Elective", :credit-hours "2(  0)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0226&dept_cd=0229&cour_cd=MEDI414&cour_cls=00&cour_nm=ANESTHESIOLOGY & PAIN MEDICINE CLERKSHIP"}}, "BUSS207-08" {:kr {:professor "김민수", :schedule ["금(1-2) 공학관 369"], :r true, :number "BUSS207-08", :name " 재무관리", :w false, :l true, :classification "전공필수 ", :credit-hours "3(  3)", :x false, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0140&dept_cd=0142&cour_cd=BUSS207&cour_cls=08&cour_nm=재무관리"}, :en {:professor "Kim, Min-Su", :schedule ["Fri(1-2) 240-369"], :r true, :number "BUSS207-08", :name "FINANCIAL MANAGEMENT", :w false, :l true, :classification "Major Required", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0140&dept_cd=0142&cour_cd=BUSS207&cour_cls=08&cour_nm=FINANCIAL MANAGEMENT"}}, "POLI228-00" {:kr {:professor "김현경", :schedule ["화(3-4) 교양관 104" "\n목(3-4) 교양관 104"], :r false, :number "POLI228-00", :name " 일본정치론(영강)", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x false, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0197&dept_cd=0199&cour_cd=POLI228&cour_cls=00&cour_nm=일본정치론(영강)"}, :en {:professor "Hyun Kyoung Kim", :schedule ["Tue(3-4) 108-104" "\nThu(3-4) 108-104"], :r false, :number "POLI228-00", :name "JAPANESE POLITICS AND SOCIETY(English)", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0197&dept_cd=0199&cour_cd=POLI228&cour_cls=00&cour_nm=JAPANESE POLITICS AND SOCIETY(English)"}}, "SAEK431-00" {:kr {:professor "김법민", :schedule [], :r true, :number "SAEK431-00", :name " 스포츠종목별트레이닝론VII", :w false, :l false, :classification "전공필수 ", :credit-hours "1(  2)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0234&dept_cd=0237&cour_cd=SAEK431&cour_cls=00&cour_nm=스포츠종목별트레이닝론VII"}, :en {:professor "Kim, Beop-Min", :schedule [], :r true, :number "SAEK431-00", :name "TRAINING THEORY FOR SPORTS EVENT VII", :w false, :l false, :classification "Major Required", :credit-hours "1(  2)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0234&dept_cd=0237&cour_cd=SAEK431&cour_cls=00&cour_nm=TRAINING THEORY FOR SPORTS EVENT VII"}}, "NMCH345-01" {:kr {:professor "이상민", :schedule ["토(1-3) 9-214c"], :r true, :number "NMCH345-01", :name " 전공연구실험I", :w false, :l true, :classification "전공선택 ", :credit-hours "1(  3)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4547&cour_cd=NMCH345&cour_cls=01&cour_nm=전공연구실험I"}, :en {:professor "Lee, Sangmin", :schedule ["Sat(1-3) 9-214c"], :r true, :number "NMCH345-01", :name "EXPERIMENTAL RESEARCH STUDY I", :w false, :l true, :classification "Major Elective", :credit-hours "1(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4547&cour_cd=NMCH345&cour_cls=01&cour_nm=EXPERIMENTAL RESEARCH STUDY I"}}, "LSSS357-01" {:kr {:professor "이현섭", :schedule ["수(5-6) 7-216" "\n수(8) 7-216"], :r true, :number "LSSS357-01", :name " 스포츠영상공학론", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS357&cour_cls=01&cour_nm=스포츠영상공학론"}, :en {:professor "LEE, Hyun Seob", :schedule ["Wed(5-6) 7-216" "\nWed(8) 7-216"], :r true, :number "LSSS357-01", :name "SPORT MOTION ANALYSIS", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS357&cour_cls=01&cour_nm=SPORT MOTION ANALYSIS"}}, "KORE223-00" {:kr {:professor "강헌국", :schedule ["월(2) 교양관 201" "\n수(2) 교양관 201"], :r true, :number "KORE223-00", :name " 현대소설론", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0145&cour_cd=KORE223&cour_cls=00&cour_nm=현대소설론"}, :en {:professor "Kang Hun Kook", :schedule ["Mon(2) 108-201" "\nWed(2) 108-201"], :r true, :number "KORE223-00", :name "MODERN KOREAN FICTION", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0145&cour_cd=KORE223&cour_cls=00&cour_nm=MODERN KOREAN FICTION"}}, "DISS242-00" {:kr {:professor "민태은", :schedule ["화(5) 국제관215" "\n목(5) 국제관215"], :r false, :number "DISS242-00", :name " 북미지역입문(영강)", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=3928&dept_cd=3931&cour_cd=DISS242&cour_cls=00&cour_nm=북미지역입문(영강)"}, :en {:professor "Min, Taeeun", :schedule ["Tue(5) 138-215" "\nThu(5) 138-215"], :r false, :number "DISS242-00", :name "CONTEMPORARY NORTH AMERICA(English)", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=3928&dept_cd=3931&cour_cd=DISS242&cour_cls=00&cour_nm=CONTEMPORARY NORTH AMERICA(English)"}}, "LSSS225-08" {:kr {:professor "박기주", :schedule ["화(9-10) "], :r true, :number "LSSS225-08", :name " 하이엔드스포츠I", :w false, :l true, :classification "전공선택 ", :credit-hours "1(  2)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS225&cour_cls=08&cour_nm=하이엔드스포츠I"}, :en {:professor ".", :schedule ["Tue(9-10)"], :r true, :number "LSSS225-08", :name "HIGH-AND SPORTS I", :w false, :l true, :classification "Major Elective", :credit-hours "1(  2)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS225&cour_cls=08&cour_nm=HIGH-AND SPORTS I"}}, "CIEN458-03" {:kr {:professor "정주노", :schedule ["금(8) 9-102" "\n금(10-11) 9-102"], :r true, :number "CIEN458-03", :name " 기전융합CapstoneDesign", :w true, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4551&cour_cd=CIEN458&cour_cls=03&cour_nm=기전융합CapstoneDesign"}, :en {:professor "Joono Cheong", :schedule ["Fri(8) 9-102" "\nFri(10-11) 9-102"], :r true, :number "CIEN458-03", :name "CAPSTONE DESIGN OF MECHATRONICS CONVERGING TECHNOLOGY", :w true, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4460&dept_cd=4551&cour_cd=CIEN458&cour_cls=03&cour_nm=CAPSTONE DESIGN OF MECHATRONICS CONVERGING TECHNOLOGY"}}, "MEDI402-00" {:kr {:professor "최성혁", :schedule [], :r false, :number "MEDI402-00", :name " 응급의학임상실습", :w false, :l false, :classification "전공필수 ", :credit-hours "2(  0)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0226&dept_cd=0229&cour_cd=MEDI402&cour_cls=00&cour_nm=응급의학임상실습"}, :en {:professor "CHOI, Sung Hyuk", :schedule [], :r false, :number "MEDI402-00", :name "EMERGENCY MEDICINE CLERKSHIP", :w false, :l false, :classification "Major Required", :credit-hours "2(  0)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0226&dept_cd=0229&cour_cd=MEDI402&cour_cls=00&cour_nm=EMERGENCY MEDICINE CLERKSHIP"}}, "ARCH329-01" {:kr {:professor "김강수", :schedule ["월(1-2) 공학관 368"], :r true, :number "ARCH329-01", :name " 건축환경계획I", :w false, :l true, :classification "전공필수 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0217&dept_cd=4887&cour_cd=ARCH329&cour_cls=01&cour_nm=건축환경계획I"}, :en {:professor "KIM, Kang Soo", :schedule ["Mon(1-2) 240-368"], :r true, :number "ARCH329-01", :name "ARCHITECTURAL ENVIRONMENTAL PLANNING I", :w false, :l true, :classification "Major Required", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0217&dept_cd=4887&cour_cd=ARCH329&cour_cls=01&cour_nm=ARCHITECTURAL ENVIRONMENTAL PLANNING I"}}, "LSSS307-00" {:kr {:professor "이규상", :schedule ["목(2-3) 7-217" "\n목(5) 7-217"], :r true, :number "LSSS307-00", :name " 운동과스포츠의학", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x false, :campus "세종", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS307&cour_cls=00&cour_nm=운동과스포츠의학"}, :en {:professor "lee ku", :schedule ["Thu(2-3) 7-217" "\nThu(5) 7-217"], :r true, :number "LSSS307-00", :name "SPORTS AND EXERCISE MEDICINE", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=5685&dept_cd=5683&cour_cd=LSSS307&cour_cls=00&cour_nm=SPORTS AND EXERCISE MEDICINE"}}, "KHBE423-00" {:kr {:professor "박용두", :schedule ["목(5-6) 하나과학관 B120호"], :r true, :number "KHBE423-00", :name " 조직공학및약물전달시스템", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4669&dept_cd=5037&cour_cd=KHBE423&cour_cls=00&cour_nm=조직공학및약물전달시스템"}, :en {:professor "Park, Yongdoo", :schedule ["Thu(5-6) B120"], :r true, :number "KHBE423-00", :name "TISSUE ENGINEERING AND DRUG DELIVERY SYSTEM", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=4669&dept_cd=5037&cour_cd=KHBE423&cour_cls=00&cour_nm=TISSUE ENGINEERING AND DRUG DELIVERY SYSTEM"}}, "STAT203-00" {:kr {:professor "임화경", :schedule ["금(5-6) 정경관202강의실"], :r true, :number "STAT203-00", :name " 통계프로그래밍입문", :w false, :l true, :classification "전공선택 ", :credit-hours "3(  3)", :x false, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0197&dept_cd=0201&cour_cd=STAT203&cour_cls=00&cour_nm=통계프로그래밍입문"}, :en {:professor "Lim Hwa Kyung", :schedule ["Fri(5-6) 131-202"], :r true, :number "STAT203-00", :name "INTRODUCTION TO STATISTICAL PROGRAMMING", :w false, :l true, :classification "Major Elective", :credit-hours "3(  3)", :x false, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0197&dept_cd=0201&cour_cd=STAT203&cour_cls=00&cour_nm=INTRODUCTION TO STATISTICAL PROGRAMMING"}}, "HOEW363-00" {:kr {:professor "원태준", :schedule ["금(5-6) 서관 224A"], :r true, :number "HOEW363-00", :name " 영국문화사(영강)", :w false, :l false, :classification "전공선택 ", :credit-hours "3(  3)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0803&cour_cd=HOEW363&cour_cls=00&cour_nm=영국문화사(영강)"}, :en {:professor "Won Tae Joon", :schedule ["Fri(5-6) 103-224A"], :r true, :number "HOEW363-00", :name "BRITISH HISTORY(English)", :w false, :l false, :classification "Major Elective", :credit-hours "3(  3)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0803&cour_cd=HOEW363&cour_cls=00&cour_nm=BRITISH HISTORY(English)"}}, "PSYC206-02" {:kr {:professor "정현선", :schedule ["화(8) 서관 123"], :r true, :number "PSYC206-02", :name " 심리통계실습", :w false, :l true, :classification "전공필수 ", :credit-hours "1(  1)", :x true, :campus "안암", :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanView.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0151&cour_cd=PSYC206&cour_cls=02&cour_nm=심리통계실습"}, :en {:professor "CHUNG, Hyun Sun", :schedule ["Tue(8) 103-123"], :r true, :number "PSYC206-02", :name "INTRODUCTORY PSYCHOLOGICAL STATISTICS AND PRACTICUM", :w false, :l true, :classification "Major Required", :credit-hours "1(  1)", :x true, :href "http://infodepot.korea.ac.kr/lecture1/lecsubjectPlanViewEng.jsp?year=2015&term=1R&grad_cd=0136&col_cd=0143&dept_cd=0151&cour_cd=PSYC206&cour_cls=02&cour_nm=INTRODUCTORY PSYCHOLOGICAL STATISTICS AND PRACTICUM"}}})

;; Utils
(defn course-hm->str [[id data]]
  (str/join " "
            [(get-in data [:kr :name])
             (get-in data [:kr :number])
             (get-in data [:kr :professor])
             (apply str (get-in data [:en :schedule]))
             (get-in data [:kr :credit-hours])
             (get-in data [:kr :classification])]))

(defn matches-query?
  [search-input course]
  (let [course-str (str/lower-case (course-hm->str course))
        search-input (str/lower-case search-input)
        search-tokens (str/split search-input #" ")]
    (every? (fn [search-token]
              (> (.indexOf course-str search-token) -1))
            search-tokens)))

;; Handlers (this will modify inner database)
(re-frame/register-handler
 :initialise-db
 (fn [_ _]
   {:courses dummy-data
    :search-input ""
    :my-courses []}))

(defn handle-search-input-entered
  [app-state [_ search-input]]
  (assoc-in app-state [:search-input] search-input))

(re-frame/register-handler
 :search-input-entered
 handle-search-input-entered)

(defn handle-course-search-entered
  [app-state _]
  (let [displayed-courses (re-frame/subscribe [:courses-to-display])
        search-elem (.getElementById js/document "search-courses")]
    (if (and (= 1 (count @displayed-courses))
             (not (get (set (get app-state :my-courses))
                       (first @displayed-courses))))
      (do (set! (.-value search-elem) "")
          (-> app-state
              (update-in [:my-courses]
                         conj
                         [(ffirst @displayed-courses)
                          (get-in (val (first @displayed-courses))
                                  [:kr :name])])
              (assoc-in [:search-input] "")))
      app-state)))

(re-frame/register-handler
 :course-search-entered
 handle-course-search-entered)

;; Subscribers (this will get data based on inner database)

(re-frame/register-sub
 :search-input
 (fn [db]
   (reaction (:search-input @db))))

(re-frame/register-sub
 :search-tokens
 (fn [db]
   (reaction (str/split (str/lower-case (:search-input @db)) #" "))))

(re-frame/register-sub
 :courses
 (fn [db]
   (reaction (:courses @db))))

(re-frame/register-sub
 :my-courses
 (fn [db]
   (reaction (:my-courses @db))))

(re-frame/register-sub
 :not-my-courses
 (let [courses (re-frame/subscribe [:courses])
       my-courses (re-frame/subscribe [:my-courses])]
   (fn [db]
     (reaction (filterv (fn [[id course-data]]
                          (not (get (set (map first @my-courses)) id)))
                        @courses)))))

;; TODO: is it right pattern?
(re-frame/register-sub
 :filtered-courses
 (let [search-input (re-frame/subscribe [:search-input])
       not-my-courses (re-frame/subscribe [:not-my-courses])]
   (fn [_]
     (reaction
      (let [filtered-courses
            (filterv (partial matches-query? @search-input) @not-my-courses)]
        (if (and (empty? filtered-courses)
                 (> (count @search-input) 0))
          (filterv
           (partial matches-query? (apply str (butlast @search-input)))
           @not-my-courses)
          filtered-courses))))))

(re-frame/register-sub
 :courses-to-display
 (let [filtered-courses (re-frame/subscribe [:filtered-courses])]
   (fn [_]
     (reaction (take 5 @filtered-courses)))))

(re-frame/register-sub
 :count-courses-in-search
 (let [filtered (re-frame/subscribe [:filtered-courses])]
   (fn [_]
     (reaction (count @filtered)))))

#_(defn parse-time [vec]
    )

(let [my-courses (re-frame/subscribe [:my-courses])
      courses (re-frame/subscribe [:courses])]
  (println
   (for [course @my-courses]
     (get-in @courses [course :en :schedule]))))
